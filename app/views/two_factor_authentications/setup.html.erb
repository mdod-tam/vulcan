<%= link_to 'Skip to main content', '#main-content', class: 'sr-only focus:not-sr-only focus:absolute focus:p-4 focus:bg-white focus:z-50' %>

<div class="max-w-4xl mx-auto px-4 py-8">
  <main id="main-content" role="main" tabindex="-1">
    <div class="bg-white rounded-lg shadow-md p-8">
      
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Secure Your Account</h1>
        <p class="mt-3 text-gray-600">Choose a method to protect your account with two-factor authentication.</p>
      </header>

      <section id="why-2fa" aria-labelledby="why-2fa-heading" class="bg-blue-50 rounded-lg p-6 mb-8">
        <h2 id="why-2fa-heading" class="text-xl font-semibold text-gray-800 mb-2">Why Use Two-Factor Authentication?</h2>
        <p class="text-gray-700">
          Two-factor authentication adds an extra layer of security to your account. Even if someone discovers your 
          password, they won’t be able to access your account without the second factor that only you possess.
        </p>
      </section>

      <section aria-labelledby="choose-2fa-heading" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 items-stretch">
        <h2 id="choose-2fa-heading" class="sr-only">Choose a two-factor authentication method</h2>

        <!-- WebAuthn/Security Key Option -->
        <article aria-labelledby="webauthn-heading" class="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition flex flex-col">
          <div class="p-5 flex-1">
            <div class="flex justify-center mb-4">
              <svg aria-hidden="true" focusable="false" class="w-16 h-16 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 116 0z" clip-rule="evenodd"/>
              </svg>
            </div>
            <h3 id="webauthn-heading" class="text-lg font-semibold text-center text-gray-800">Security Key</h3>
            <div class="mt-2 flex justify-center">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                Strongest Security
              </span>
            </div>
            <p class="mt-3 text-gray-600 text-center">
              Use a physical security key or built‑in biometric authentication like fingerprint or facial recognition.
            </p>
          </div>
          <div class="p-5 pt-0">
            <div class="flex flex-col space-y-2">
              <%= link_to new_credential_two_factor_authentication_path(type: 'webauthn'),
                  class: 'w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500',
                  role: 'button' do %>
                <svg aria-hidden="true" focusable="false" class="mr-2 h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 116 0z" clip-rule="evenodd"/>
                </svg>
                Set Up Security Key / Biometrics
              <% end %>
            </div>
          </div>
        </article>

        <!-- TOTP Option -->
        <article aria-labelledby="totp-heading" class="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition flex flex-col">
          <div class="p-5 flex-1">
            <div class="flex justify-center mb-4">
              <svg aria-hidden="true" focusable="false" class="w-16 h-16 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
              </svg>
            </div>
            <h3 id="totp-heading" class="text-lg font-semibold text-center text-gray-800">Authenticator App</h3>
            <div class="mt-2 flex justify-center">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                Strong Security
              </span>
            </div>
            <p class="mt-3 text-gray-600 text-center">
              Use an authenticator app like Google Authenticator, Microsoft Authenticator, or Authy to generate verification codes.
            </p>
          </div>
          <div class="p-5 pt-0">
            <div class="flex flex-col space-y-2">
              <%= link_to new_credential_two_factor_authentication_path(type: 'totp'),
                  class: 'w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500',
                  role: 'button' do %>
                <svg aria-hidden="true" focusable="false" class="mr-2 h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"/>
                </svg>
                Set Up Authenticator App
              <% end %>
            </div>
          </div>
        </article>

        <!-- SMS Option -->
        <article aria-labelledby="sms-heading" class="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition flex flex-col">
          <div class="p-5 flex-1">
            <div class="flex justify-center mb-4">
              <svg aria-hidden="true" focusable="false" class="w-16 h-16 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path>
              </svg>
            </div>
            <h3 id="sms-heading" class="text-lg font-semibold text-center text-gray-800">Text Message</h3>
            <div class="mt-2 flex justify-center">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                Basic Security
              </span>
            </div>
            <p class="mt-3 text-gray-600 text-center">
              Receive a verification code via text message (SMS) on your mobile phone when you sign in.
            </p>
          </div>
          <div class="p-5 pt-0">
            <div class="flex flex-col space-y-2">
              <%= link_to new_credential_two_factor_authentication_path(type: 'sms'),
                  class: 'w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500',
                  role: 'button' do %>
                <svg aria-hidden="true" focusable="false" class="mr-2 h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"></path>
                  <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"></path>
                </svg>
                Set Up Text Message
              <% end %>
            </div>
          </div>
        </article>

      </section>

      <aside role="note" aria-labelledby="recommendation-heading" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <div class="flex">
          <div class="flex-shrink-0">
            <svg aria-hidden="true" focusable="false" class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
            </svg>
          </div>
          <div class="ml-3">
            <h3 id="recommendation-heading" class="text-sm font-medium text-yellow-800">Recommendation</h3>
            <div class="mt-2 text-sm text-yellow-700">
              <p>
                For maximum security, we recommend using a security key or biometric authentication. If that’s not available, authenticator apps provide strong protection without requiring a network connection during verification.
              </p>
            </div>
          </div>
        </div>
      </aside>

      <div class="mt-8 text-center">
        <%= link_to 'Skip for now (not recommended)', root_path, class: 'text-indigo-600 hover:text-indigo-800 font-medium' %>
      </div>

    </div>
  </main>
</div>
